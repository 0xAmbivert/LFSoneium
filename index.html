<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soneium dApp v1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root { --bg: #0f111a; --card: #1a1d29; --text: #f0f0f0; --primary: #3d5afe; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; display: flex; justify-content: center; padding: 40px; }
        .card { background: var(--card); padding: 30px; border-radius: 16px; width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid #2d3142; }
        h2 { margin-top: 0; color: var(--primary); text-align: center; }
        .stats { background: #000; padding: 15px; border-radius: 8px; margin: 20px 0; font-family: monospace; font-size: 13px; }
        .btn { width: 100%; padding: 14px; margin: 10px 0; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; background: #2a2e3f; color: white; transition: 0.3s; }
        .btn:hover { background: var(--primary); }
        #log { margin-top: 20px; font-size: 11px; color: #888; height: 100px; overflow-y: auto; border-top: 1px solid #333; padding-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Soneium v1</h2>
    
    <div class="stats">
        <div>Address: <span id="addr">Not Connected</span></div>
        <div>ETH: <span id="eth">0.00</span></div>
        <div>WETH: <span id="weth">0.00</span></div>
    </div>

    <button class="btn" style="background: var(--primary);" onclick="connect()">Connect Wallet</button>
    <button class="btn" onclick="wrapETH()">Wrap 0.001 ETH</button>
    <button class="btn" onclick="unwrapETH()">Unwrap 0.001 WETH</button>
    <button class="btn" onclick="refresh()">Refresh Balances</button>

    <div id="log">>> Dashboard v1 ready.</div>
</div>

<script>
    let provider, signer, myAddr;
    
    const WETH_ADDR = "0x4200000000000000000000000000000000000006";
    const WETH_ABI = [
        "function deposit() payable",
        "function withdraw(uint256 wad)",
        "function balanceOf(address) view returns (uint256)"
    ];

    function log(msg) {
        const l = document.getElementById('log');
        l.innerHTML += `<br>> ${msg}`;
        l.scrollTop = l.scrollHeight;
    }

    async function connect() {
        if (window.ethereum) {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            myAddr = await signer.getAddress();
            document.getElementById('addr').innerText = myAddr.substring(0,6) + "..." + myAddr.substring(38);
            log("Wallet connected.");
            refresh();
        } else { alert("Install MetaMask"); }
    }

    async function refresh() {
        if (!signer) return;
        const ethBal = await provider.getBalance(myAddr);
        const wethContract = new ethers.Contract(WETH_ADDR, WETH_ABI, provider);
        const wethBal = await wethContract.balanceOf(myAddr);
        
        document.getElementById('eth').innerText = parseFloat(ethers.utils.formatEther(ethBal)).toFixed(4);
        document.getElementById('weth').innerText = parseFloat(ethers.utils.formatEther(wethBal)).toFixed(4);
        log("Balances updated.");
    }

    async function wrapETH() {
        try {
            log("Wrapping ETH...");
            const contract = new ethers.Contract(WETH_ADDR, WETH_ABI, signer);
            const tx = await contract.deposit({ value: ethers.utils.parseEther("0.001") });
            await tx.wait();
            log("Success! Wrapped 0.001 ETH.");
            refresh();
        } catch (e) { log("Error: " + e.message.substring(0, 40)); }
    }

    async function unwrapETH() {
        try {
            log("Unwrapping WETH...");
            const contract = new ethers.Contract(WETH_ADDR, WETH_ABI, signer);
            const tx = await contract.withdraw(ethers.utils.parseEther("0.001"));
            await tx.wait();
            log("Success! Unwrapped 0.001 WETH.");
            refresh();
        } catch (e) { log("Error: " + e.message.substring(0, 40)); }
    }
</script>
</body>
</html>
